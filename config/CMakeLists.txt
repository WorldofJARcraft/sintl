function (configure_libsintl targetName)
    include(CheckSymbolExists)

    check_symbol_exists(fstat64 "sys/stat.h" HAVE_FSTAT64)
    check_symbol_exists(getauxval "sys/auxv.h" HAVE_GETAUXVAL)
    check_symbol_exists(issetugid "unistd.h" HAVE_ISSETUGID)
    check_symbol_exists(uselocale "locale.h" HAVE_USELOCALE)
    check_symbol_exists(getlocalename_l "locale.h" HAVE_GETLOCALENAME_L)
    check_symbol_exists(querylocale "locale.h" HAVE_QUERYLOCALE)


    set(ExtraCompileOptions "")

    if(${HAVE_FSTAT64})
        string(APPEND ExtraCompileOptions "-DHAVE_STAT64")
        message("Configuration options: Have fstat64: ${HAVE_FSTAT64}")
    else()
        message("Configuration options: Have fstat64: no")
    endif()

    if(${HAVE_GETAUXVAL})
        string(APPEND ExtraCompileOptions "-DHAVE_GATAUXVAL")
        message("Configuration options: Have getauxval: ${HAVE_GETAUXVAL}")
    else()
        message("Configuration options: Have getauxval: no")
    endif()

    if(${HAVE_ISSETUGID})
        string(APPEND ExtraCompileOptions "-DHAVE_ISSETUGID")
        message("Configuration options: Have issetugid: ${HAVE_ISSETUGID}")
    else()
        message("Configuration options: Have issetugid: no")
    endif()

    if(${HAVE_USELOCALE})
        if(${HAVE_GETLOCALENAME_L})
            string(APPEND ExtraCompileOptions "-DHAVE_USELOCALE -DHAVE_GETLOCALENAME_L")
            message("Configuration options: Have uselocale: 1")
            message("Configuration options: Have getlocalename_l: 1")
        elseif(${HAVE_QUERYLOCALE})
            string(APPEND ExtraCompileOptions "-DHAVE_USELOCALE -DHAVE_QUERYLOCALE")
            message("Configuration options: Have uselocale: 1")
            message("Configuration options: Have querylocale: 1")
        else()
            message("Configuration options: Have uselocale: 0")
            message("Have uselocale but no getlocalename_l or querylocale - cannot map selected locale to name!")
        endif()
    else()
        message("Configuration options: Have working uselocale: 0")
        message("Do not have uselocale!")
    endif()

    target_compile_options(${targetName} PRIVATE ${ExtraCompileOptions})
endfunction()